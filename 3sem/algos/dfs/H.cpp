// решение: тупо dfs с бинпоиском (да-да, оно задет) 